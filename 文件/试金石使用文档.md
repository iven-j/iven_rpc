# 试金石使用文档

![image-20240725163241179](C:\Users\jiangyinwen1\AppData\Roaming\Typora\typora-user-images\image-20240725163241179.png)



在服务端的话，试金石是给出对应的标签，客户端会进行后续的SDK调用处理



### AB实验

 **AB实验**，也被称为线上对照实验，是业务迭代中正式全量前的一个测试环节。即通过hash算法**对线上流量进行随机分组（**保证不同分组用户的同质性，以排除其他因素对A/B实验的干扰），**每组分别命中不同业务方案**（针对一个需求点同时运行多组方案），**对比不同组用户指标评估方案效果**，以辅助业务决策。

#### 试金石平台支持的AB实验类型

![image-20240723162855858](C:\Users\jiangyinwen1\AppData\Roaming\Typora\typora-user-images\image-20240723162855858.png)

##### 随机分流实验

随机分流，是一种通过**随机分配实验对象到不同实验组**的方法，以研究多个变量对实验结果的影响。在随机分流过程中，实验对象根据特定的规则被分为不同的组别，如实验组和对照组，以比较不同变量对实验结果的影响。

**实现原理介绍：**

- 检查准入条件，符合条件的用户进入实验分流打标，未符合条件用户则统一返回未命中实验的标签（版本是 misstsab）
- 检查白名单设置（白名单是页面配置的，如命中白名单，则返回白名单配置的版本。注意，sdk 中提供了 whiteuser 字段，优先级高于页面配置）
- 生成 hash 种子，hash 种子=userPin+userId+deviceId+salt（如果 userPin+userId+deviceId 为空字符串，则用 uuid 替代。以上信息用户通过 sdk 接口传入）

根据 hash 种子生成 hash 值，根据 hash 值获取桶位 index。

平台会根据流量比例设置好桶位信息共 100 个桶位，根据第三步的桶位 index 获取对应桶位的版本信息。

**举例：**

在平台创建了一个实验，有 A、B 两个版本，经过多次调整流量比例之后流量比例为 30:70，

平台生成桶位信息为["A","B","B","A","A","B","B","B","B","B"]。以 10 个举例，实际是 100 个。

根据 hash 值生成桶位 index，假设为 3，则返回 A 版本，从 0 开始。

![image-20240723162827721](C:\Users\jiangyinwen1\AppData\Roaming\Typora\typora-user-images\image-20240723162827721.png)

###### 分层实验

###### **联合实验**

##### 人群定向实验

![image-20240723162816999](C:\Users\jiangyinwen1\AppData\Roaming\Typora\typora-user-images\image-20240723162816999.png)

#### 哪些需求需要做AB实验

**原则上凡是能影响到用户的迭代都需要A/B实验**。



##### 业务服务端接入试金石分流接口，传入实验ID和用户信息获取分流结果‘label’，根据命中的实验版本走对应的业务逻辑



### 试金石SDK

#### 接入

#### 同步机制





### 试金石通用工具封装



### 埋点

埋点又称为事件追踪（Event Tracking），指的是针对特定用户行为或事件进行捕获，处理和发送的相关技术及其实施过程。

功能方面：埋点是用来收集用户行为数据。比如想要了解一个用户在APP里面点击了哪些按钮，看了哪些页面，做了哪些事情等，就可以通过埋点来实现。

实现方式方面：埋点就是通过植入一段代码到某个页面或某个按钮，从而监听用户行为并进行收集上报，可使用子午线平台进行埋点。



### 灰度





### 实验背景



### 方法





### 数据分析





### 代码阅读

Q1：为什么要添加这个判断

![image-20240729170148910](C:\Users\jiangyinwen1\AppData\Roaming\Typora\typora-user-images\image-20240729170148910.png)





周报的话就上周就写之前那个连麦风控的上线，然后本周的写试金石文档整理



试金石残余实验收集以及使用手册，服务端上报与客户端上报区别



### 残余试金石实验

###### 购物袋置顶商卡实验 livesoa_46909

LiveCartBaseDataV1180ServiceImpl.java



###### 先享后付0元试用

livesoa_46915  已经清理干净了





用uuid的实验



这周要更新简历了

直接把实习的经历更新上去，把试金石封装写进去，直播购物袋搜索更新写进去，



然后把RPC的直接抄进去，外卖的把领券啥的给干掉，

bazookeeper以及JSF中间件什么的写进去’



### 使用说明

已经集成了试金石方法，该有服务端进行埋点上报，

客户端上报与服务端上报的区别：

客户端上报：获取实验标识后透传至客户端，跟随业务埋点上报至子午线客户端日志表，从中加工实验数据（客户端需升级埋点增加试金石实验标识参

服务端上报：获取实验标识后由服务端上报至子午线，通过traceID与子午线客户端埋点日志关联产出实验数据（客户端无需改造，用户需在试金石页面配置理点信息